<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}LITReview{% endblock %}</title>
    {% comment %} Le titre peut être remplacé dans chaque template enfant grâce au block title {% endcomment %}
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      {% comment %} Style global de l'application (mise en page et composants principaux) {% endcomment %}
      body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;margin:0;color:#111}
      a{color:#111;text-decoration:none} a:hover{text-decoration:none}
      .container{max-width:980px;margin:0 auto;padding:16px}
      header{border-bottom:1px solid #e5e7eb;background:#fff;position:sticky;top:0}
      .brand{font-weight:700;font-size:20px;text-align:center;flex-grow:1}
      nav a, nav form{margin-left:16px}
      .btn, a.btn{display:inline-block;padding:10px 16px;border:1px solid #111;border-radius:8px;background:#fff;color:#111;text-decoration:none}
      main{padding:16px 0}
      .flash{background:#f1f5f9;border:1px solid #e2e8f0;padding:10px;border-radius:8px;margin:10px 0}
      .grid2{display:flex;gap:16px;justify-content:center;flex-wrap:wrap;margin-bottom:24px}
      form label{display:block;margin:8px 0 4px}
      input[type="text"],input[type="password"],input[type="file"],textarea,select{width:100%;max-width:560px;padding:8px;border:1px solid #cbd5e1;border-radius:6px}
      button{cursor:pointer}
      .muted{color:#555}
      .card{border:1px solid #e5e7eb;border-radius:10px;padding:12px;margin:12px 0;background:#fff}
    </style>
  </head>
  <body>
    <header>
      <div class="container" style="display:flex;align-items:center;justify-content:space-between;">
        <span class="brand">LITReview</span>
        {% comment %} titre de l'application affiché en haut de toutes les pages {% endcomment %}

        {% if request.user.is_authenticated %}
          {% comment %} Si l'utilisateur est connecté, on affiche la navigation complète {% endcomment %}
          <nav style="display:flex;align-items:center;">
            <a href="{% url 'feed' %}">Flux</a>
            <a href="{% url 'my_posts' %}">Posts</a>
            <a href="{% url 'subscriptions' %}">Abonnements</a>

            {% comment %} frmulaire POST pour se déconnecter en sécurité {% endcomment %}
            <form method="post" action="{% url 'logout' %}" style="display:inline">
              {% csrf_token %}
              <button type="submit" class="btn">Se déconnecter</button>
            </form>
          </nav>
        {% else %}
          {% comment %} si l'utilisateur n'est pas connecté, on affiche se connecter et s'inscrire {% endcomment %}
          {% block header_nav %}
            <nav style="display:flex;align-items:center;">
              <a href="{% url 'login' %}">Se connecter</a>
              <a class="btn" href="{% url 'signup' %}">S'inscrire</a>
            </nav>
          {% endblock %}
        {% endif %}
      </div>
    </header>

    <div class="container">
      {% if messages %}
        {% comment %} Zone d'affichage des messages flash (succès, erreurs, infos) {% endcomment %}
        <div class="flash">{% for m in messages %}<div>{{ m }}</div>{% endfor %}</div>
      {% endif %}

      {% comment %} Zone principale où chaque page va injecter son contenu {% endcomment %}
      <main>{% block content %}{% endblock %}</main>
    </div>
  </body>
</html>
